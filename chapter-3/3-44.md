## Exercise 3.44

Firstly, observe that we could define the first exchange program in terms of the transfer program:

``` Scheme
(define (exchange account1 account2)
  (let ((difference (- (account1 'balance)
                       (account2 'balance))))
    (transfer account1 account2 difference)))
```
As illustrated by this definition, the essential difference between the transfer problem and the exchange problem is that transfer allows any amount to be transferred, whereas in the exchange, the amount transferred is the difference.

The main problem with this exchange program is that firstly the two account balances are accessed, but then could change before the transfer happens, because accessing the balance is not serialised with the transfer.

So long as the transfer amount does not have a dependency on either account balance, then Ben has a point that the transfer will *eventually* produce the correct result.

I say *eventually*, because it would still be possible to view the account balances in-between the `withdraw` and `deposit` transactions of the `transfer` program. Therefore, it's possible to read incorrect intermediary balances, where the withdrawal has happened but the deposit has not happened yet. For that reason, I'm inclined to agree with Louis that it is better to serialise `transfer` properly as a full transaction.