# Exercise 4.72

## Explanation

Like in section 3.5.3, the use of interleaving should help finding solutions across different search spaces in different frames, without getting stuck in one frame which is an infinite stream. If we append the streams instead, we will can get stuck searching in the first stream indefinitely if it is infinite.

## Example

Defining `disjoin` and `flatten-stream` using appending instead of interleaving:

``` Scheme
(define (disjoin disjuncts frame-stream)
  (if (empty-disjunction? disjuncts)
      the-empty-stream
      (stream-append-delayed
       (qeval (first-disjunct disjuncts) frame-stream)
       (delay (disjoin (rest-disjuncts disjuncts)
                       frame-stream)))))

(define (flatten-stream stream)
  (if (stream-null? stream)
      the-empty-stream
      (stream-append-delayed
       (stream-car stream)
       (delay (flatten-stream (stream-cdr stream))))))
```

Then when I run this query:

``` Scheme
(assert! (friends Bill Ben))
(assert! (friends John Paul))

(assert! (rule (friends ?x ?y)
               (friends ?y ?x)))

(or (friends Bill ?x) (friends John ?y))
```

The driver loops outputs this line infinitely:

``` Scheme
(or (friends bill ben) (friends john ?y))
(or (friends bill ben) (friends john ?y))
(or (friends bill ben) (friends john ?y))
; ...
```

In the original version of the evaluator, interleaving helps us get solutions for both queries, although it outputs them infinitely:

``` Scheme
(or (friends bill ?x) (friends john paul))
(or (friends bill ben) (friends john ?y))
(or (friends bill ?x) (friends john paul))
(or (friends bill ben) (friends john ?y))
(or (friends bill ?x) (friends john paul))
(or (friends bill ben) (friends john ?y))
; ...
```

As an aside, I initially tried to query `(outranked-by (Reasoner Louis) ?boss)`, using the infinitely recursive version of `outranked-by`. I actually got more results back using append than with using interleave.

So I think this is complex and dependent on specific examples. There are several issues relating to infinite loops that aren't solved by interleave at all.